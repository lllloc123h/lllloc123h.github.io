import{_ as $,r as m,c as A,i as L,j as g,a as s,b as t,w as r,v as c,F as p,g as T,d as X,t as e,f as N,o as u}from"./index-DO-IbZNU.js";const V={class:"container-fluid"},F={class:"row"},E={class:"ms-sm-auto px-4 pt-4"},U={class:"card p-3 mb-4 shadow-sm"},B={class:"row g-3 align-items-end"},M={class:"col-md-2 col-sm-6"},S={class:"col-md-2 col-sm-6"},j={class:"col-md-3 col-lg-2 col-sm-6"},I=["value"],q={class:"col-md-3 col-lg-2 col-sm-6"},O=["disabled"],G=["value"],Q={class:"col-md-3 col-lg-2 col-sm-6"},z={class:"table-responsive"},J={class:"table table-bordered table-hover caption-top"},R=["onDblclick"],W={class:"text-center"},Y={class:"text-center"},Z={class:"text-center"},nn={class:"text-center"},tn={class:"text-center"},_n={class:"text-center"},an={key:0},on={__name:"TheoDoiTienDo",setup(hn){const o=m({kyDieuTra:"4",nam:"2025",maTinh:"",maHuyen:"",thongKeTheo:"3-xa"}),y=m([{ma:"87",ten:"Đồng Tháp"},{ma:"88",ten:"Long An"},{ma:"89",ten:"An Giang"}]),d=m([]);m([]);const f=m([]),v=A(()=>{let h=f.value;if(h=h.filter(n=>n.ky_dieu_tra===o.value.kyDieuTra&&n.nam===o.value.nam),o.value.maTinh&&(h=h.filter(n=>n.ma_tinh===o.value.maTinh)),o.value.maHuyen&&(h=h.filter(n=>n.ma_huyen===o.value.maHuyen)),o.value.thongKeTheo==="1-tinh"){const n={};return h.forEach(_=>{var l;n[_.ma_tinh]||(n[_.ma_tinh]={stt:0,ma_tinh:_.ma_tinh,ma_huyen:"",ma_xa:"",ten:((l=y.value.find(x=>x.ma===_.ma_tinh))==null?void 0:l.ten)||`Tỉnh ${_.ma_tinh}`,dn_htx_so_luong:0,dn_htx_hoan_thanh:0,dn_htx_ty_le:0,ho_so_luong:0,ho_hoan_thanh:0,ho_ty_le:0,ky_dieu_tra:_.ky_dieu_tra,nam:_.nam}),n[_.ma_tinh].dn_htx_so_luong+=_.dn_htx_so_luong,n[_.ma_tinh].dn_htx_hoan_thanh+=_.dn_htx_hoan_thanh,n[_.ma_tinh].ho_so_luong+=_.ho_so_luong,n[_.ma_tinh].ho_hoan_thanh+=_.ho_hoan_thanh}),Object.values(n).map((_,l)=>(_.dn_htx_ty_le=_.dn_htx_so_luong>0?(_.dn_htx_hoan_thanh/_.dn_htx_so_luong*100).toFixed(2):"0.00",_.ho_ty_le=_.ho_so_luong>0?(_.ho_hoan_thanh/_.ho_so_luong*100).toFixed(2):"0.00",_.stt=l+1,_))}else if(o.value.thongKeTheo==="2-huyen"){const n={};return h.forEach(_=>{var x;const l=`${_.ma_tinh}-${_.ma_huyen}`;n[l]||(n[l]={stt:0,ma_tinh:_.ma_tinh,ma_huyen:_.ma_huyen,ma_xa:"",ten:((x=d.value.find(D=>D.ma===_.ma_huyen&&D.ma_tinh===_.ma_tinh))==null?void 0:x.ten)||`Huyện ${_.ma_huyen}`,dn_htx_so_luong:0,dn_htx_hoan_thanh:0,dn_htx_ty_le:0,ho_so_luong:0,ho_hoan_thanh:0,ho_ty_le:0,ky_dieu_tra:_.ky_dieu_tra,nam:_.nam}),n[l].dn_htx_so_luong+=_.dn_htx_so_luong,n[l].dn_htx_hoan_thanh+=_.dn_htx_hoan_thanh,n[l].ho_so_luong+=_.ho_so_luong,n[l].ho_hoan_thanh+=_.ho_hoan_thanh}),Object.values(n).map((_,l)=>(_.dn_htx_ty_le=_.dn_htx_so_luong>0?(_.dn_htx_hoan_thanh/_.dn_htx_so_luong*100).toFixed(2):"0.00",_.ho_ty_le=_.ho_so_luong>0?(_.ho_hoan_thanh/_.ho_so_luong*100).toFixed(2):"0.00",_.stt=l+1,_))}return o.value.maHuyen&&o.value.maTinh,h.map((n,a)=>({...n,stt:a+1}))}),w=(h,n)=>`${h.ma_tinh}-${h.ma_huyen}-${h.ma_xa||"all"}-${h.ky_dieu_tra}-${h.nam}-${n}`,k=(h,n=100)=>new Promise(a=>setTimeout(()=>a(h),n));async function b(){if(o.value.maHuyen="",d.value=[],o.value.maTinh){const h=[{ma:"870",ten:"Hồng Ngự",ma_tinh:"87"},{ma:"871",ten:"Tam Nông",ma_tinh:"87"},{ma:"880",ten:"TP Tân An",ma_tinh:"88"},{ma:"881",ten:"Thủ Thừa",ma_tinh:"88"},{ma:"890",ten:"TP Long Xuyên",ma_tinh:"89"},{ma:"891",ten:"Châu Đốc",ma_tinh:"89"}];d.value=await k(h.filter(n=>n.ma_tinh===o.value.maTinh)),d.value.length>0&&(o.value.maHuyen=d.value[0].ma)}i()}async function K(){i()}async function H(){console.log("Đang lấy dữ liệu điều tra với các bộ lọc:",o.value);const h=[{ky_dieu_tra:"4",nam:"2025",ma_tinh:"87",ma_huyen:"870",ma_xa:"29956",ten:"Xã Thường Phước 1",dn_htx_so_luong:0,dn_htx_hoan_thanh:0,dn_htx_ty_le:"0.00",ho_so_luong:0,ho_hoan_thanh:0,ho_ty_le:"0.00"},{ky_dieu_tra:"4",nam:"2025",ma_tinh:"87",ma_huyen:"870",ma_xa:"29962",ten:"Xã Thường Thới Hậu A",dn_htx_so_luong:0,dn_htx_hoan_thanh:0,dn_htx_ty_le:"0.00",ho_so_luong:18,ho_hoan_thanh:18,ho_ty_le:"100.00"},{ky_dieu_tra:"4",nam:"2025",ma_tinh:"87",ma_huyen:"870",ma_xa:"29967",ten:"Xã Thường Phước 2",dn_htx_so_luong:0,dn_htx_hoan_thanh:0,dn_htx_ty_le:"0.00",ho_so_luong:43,ho_hoan_thanh:43,ho_ty_le:"100.00"},{ky_dieu_tra:"4",nam:"2025",ma_tinh:"87",ma_huyen:"870",ma_xa:"29971",ten:"Thị trấn Thường Thới Tiền",dn_htx_so_luong:0,dn_htx_hoan_thanh:0,dn_htx_ty_le:"0.00",ho_so_luong:34,ho_hoan_thanh:34,ho_ty_le:"100.00"},{ky_dieu_tra:"4",nam:"2025",ma_tinh:"87",ma_huyen:"870",ma_xa:"29974",ten:"Xã Thường Lạc",dn_htx_so_luong:0,dn_htx_hoan_thanh:0,dn_htx_ty_le:"0.00",ho_so_luong:14,ho_hoan_thanh:14,ho_ty_le:"100.00"},{ky_dieu_tra:"4",nam:"2025",ma_tinh:"87",ma_huyen:"870",ma_xa:"29977",ten:"Xã Long Thuận",dn_htx_so_luong:0,dn_htx_hoan_thanh:0,dn_htx_ty_le:"0.00",ho_so_luong:26,ho_hoan_thanh:26,ho_ty_le:"100.00"},{ky_dieu_tra:"4",nam:"2025",ma_tinh:"87",ma_huyen:"870",ma_xa:"29980",ten:"Xã Long Khánh A",dn_htx_so_luong:0,dn_htx_hoan_thanh:0,dn_htx_ty_le:"0.00",ho_so_luong:2,ho_hoan_thanh:2,ho_ty_le:"100.00"},{ky_dieu_tra:"4",nam:"2025",ma_tinh:"87",ma_huyen:"870",ma_xa:"29983",ten:"Xã Long Khánh B",dn_htx_so_luong:0,dn_htx_hoan_thanh:0,dn_htx_ty_le:"0.00",ho_so_luong:4,ho_hoan_thanh:4,ho_ty_le:"100.00"},{ky_dieu_tra:"4",nam:"2025",ma_tinh:"87",ma_huyen:"870",ma_xa:"29992",ten:"Xã Phú Thuận B",dn_htx_so_luong:0,dn_htx_hoan_thanh:0,dn_htx_ty_le:"0.00",ho_so_luong:17,ho_hoan_thanh:17,ho_ty_le:"100.00"},{ky_dieu_tra:"4",nam:"2025",ma_tinh:"87",ma_huyen:"870",ma_xa:"29995",ten:"Xã Phú Thuận A",dn_htx_so_luong:0,dn_htx_hoan_thanh:0,dn_htx_ty_le:"0.00",ho_so_luong:4,ho_hoan_thanh:4,ho_ty_le:"100.00"},{ky_dieu_tra:"4",nam:"2025",ma_tinh:"87",ma_huyen:"870",ma_xa:"29998",ten:"Xã Phú Thuận",dn_htx_so_luong:0,dn_htx_hoan_thanh:0,dn_htx_ty_le:"0.00",ho_so_luong:22,ho_hoan_thanh:22,ho_ty_le:"100.00"},{ky_dieu_tra:"4",nam:"2025",ma_tinh:"87",ma_huyen:"871",ma_xa:"30000",ten:"Thị trấn Tràm Chim",dn_htx_so_luong:5,dn_htx_hoan_thanh:3,dn_htx_ty_le:"60.00",ho_so_luong:50,ho_hoan_thanh:45,ho_ty_le:"90.00"},{ky_dieu_tra:"4",nam:"2025",ma_tinh:"87",ma_huyen:"871",ma_xa:"30001",ten:"Xã Phú Cường",dn_htx_so_luong:2,dn_htx_hoan_thanh:2,dn_htx_ty_le:"100.00",ho_so_luong:30,ho_hoan_thanh:30,ho_ty_le:"100.00"},{ky_dieu_tra:"4",nam:"2025",ma_tinh:"88",ma_huyen:"880",ma_xa:"30100",ten:"Phường 1",dn_htx_so_luong:10,dn_htx_hoan_thanh:8,dn_htx_ty_le:"80.00",ho_so_luong:120,ho_hoan_thanh:100,ho_ty_le:"83.33"},{ky_dieu_tra:"3",nam:"2024",ma_tinh:"87",ma_huyen:"870",ma_xa:"29962",ten:"Xã Thường Thới Hậu A (Kỳ 3, 2024)",dn_htx_so_luong:0,dn_htx_hoan_thanh:0,dn_htx_ty_le:"0.00",ho_so_luong:15,ho_hoan_thanh:10,ho_ty_le:"66.67"},{ky_dieu_tra:"3",nam:"2024",ma_tinh:"88",ma_huyen:"880",ma_xa:"30100",ten:"Phường 1 (Kỳ 3, 2024)",dn_htx_so_luong:8,dn_htx_hoan_thanh:5,dn_htx_ty_le:"62.50",ho_so_luong:100,ho_hoan_thanh:80,ho_ty_le:"80.00"}];f.value=await k(h)}function i(){console.log("Áp dụng bộ lọc:",o.value)}function C(){alert("Chức năng Xuất Excel (cần implement logic)")}function P(h){alert(`Nhấn đúp vào dòng: Hiển thị danh sách hộ/doanh nghiệp chưa điều tra cho ${h.ten}. (Cần implement logic điều hướng/modal)`)}return L(()=>{o.value.maTinh=y.value.length>0?y.value[0].ma:"",H()}),g(()=>o.value.maTinh,(h,n)=>{h!==n&&b()},{immediate:!0}),g(()=>o.value.maHuyen,(h,n)=>{h!==n&&i()}),g(()=>o.value.thongKeTheo,(h,n)=>{h!==n&&i()}),g([()=>o.value.kyDieuTra,()=>o.value.nam],()=>{H()}),(h,n)=>(u(),s("div",V,[t("div",F,[t("main",E,[n[19]||(n[19]=t("h2",{class:"text-center mb-4"},"Thông tin kê khai",-1)),t("div",U,[t("div",B,[t("div",M,[n[6]||(n[6]=t("label",{for:"kyDieuTra",class:"form-label"},"Kỳ điều tra",-1)),r(t("select",{"onUpdate:modelValue":n[0]||(n[0]=a=>o.value.kyDieuTra=a),class:"form-select",id:"kyDieuTra"},n[5]||(n[5]=[t("option",{value:"4"},"4",-1),t("option",{value:"3"},"3",-1),t("option",{value:"2"},"2",-1),t("option",{value:"1"},"1",-1)]),512),[[c,o.value.kyDieuTra]])]),t("div",S,[n[8]||(n[8]=t("label",{for:"nam",class:"form-label"},"Năm",-1)),r(t("select",{"onUpdate:modelValue":n[1]||(n[1]=a=>o.value.nam=a),class:"form-select",id:"nam"},n[7]||(n[7]=[t("option",null,"2025",-1),t("option",null,"2024",-1),t("option",null,"2023",-1)]),512),[[c,o.value.nam]])]),t("div",j,[n[10]||(n[10]=t("label",{for:"tinhTp",class:"form-label"},"Tỉnh/TP",-1)),r(t("select",{"onUpdate:modelValue":n[2]||(n[2]=a=>o.value.maTinh=a),class:"form-select",id:"tinhTp",onChange:b},[n[9]||(n[9]=t("option",{value:""},"--Chọn Tỉnh--",-1)),(u(!0),s(p,null,T(y.value,a=>(u(),s("option",{key:a.ma,value:a.ma},e(a.ma)+" - "+e(a.ten),9,I))),128))],544),[[c,o.value.maTinh]])]),t("div",q,[n[12]||(n[12]=t("label",{for:"quanHuyen",class:"form-label"},"Quận/Huyện",-1)),r(t("select",{"onUpdate:modelValue":n[3]||(n[3]=a=>o.value.maHuyen=a),class:"form-select",id:"quanHuyen",onChange:K,disabled:!d.value.length},[n[11]||(n[11]=t("option",{value:""},"--Chọn Huyện--",-1)),(u(!0),s(p,null,T(d.value,a=>(u(),s("option",{key:a.ma,value:a.ma},e(a.ma)+" - "+e(a.ten),9,G))),128))],40,O),[[c,o.value.maHuyen]])]),t("div",Q,[n[14]||(n[14]=t("label",{for:"thongKeTheo",class:"form-label"},"Thống kê theo",-1)),r(t("select",{"onUpdate:modelValue":n[4]||(n[4]=a=>o.value.thongKeTheo=a),class:"form-select",id:"thongKeTheo"},n[13]||(n[13]=[t("option",{value:"3-xa"},"3-Xã",-1),t("option",{value:"2-huyen"},"2-Huyện",-1),t("option",{value:"1-tinh"},"1-Tỉnh",-1)]),512),[[c,o.value.thongKeTheo]])]),t("div",{class:"col-md-auto"},[t("button",{class:"btn btn-primary",onClick:i},n[15]||(n[15]=[t("i",{class:"bi bi-search"},null,-1),X(" Xem ")]))])])]),t("div",{class:"d-flex justify-content-end mb-3"},[t("button",{class:"btn btn-success",onClick:C},n[16]||(n[16]=[t("i",{class:"bi bi-file-earmark-excel"},null,-1),X(" Xuất Excel ")]))]),t("div",z,[t("table",J,[t("caption",null,"Tổng số bản ghi: "+e(v.value.length),1),n[18]||(n[18]=t("thead",{class:"table-primary"},[t("tr",null,[t("th",{rowspan:"2",scope:"col"},"STT"),t("th",{rowspan:"2",scope:"col"},"Mã Tỉnh"),t("th",{rowspan:"2",scope:"col"},"Mã Huyện"),t("th",{rowspan:"2",scope:"col"},"Mã Xã"),t("th",{rowspan:"2",scope:"col",style:{"min-width":"180px"}},"Tên (Nhấn đúp vào dòng để hiển thị danh sách chưa thực hiện điều tra)"),t("th",{colspan:"3",class:"text-center"},"Điều tra Doanh nghiệp, HTX"),t("th",{colspan:"3",class:"text-center"},"Điều tra Hộ")]),t("tr",null,[t("th",{scope:"col",class:"text-center"},"Số lượng"),t("th",{scope:"col",class:"text-center"},"Hoàn thành"),t("th",{scope:"col",class:"text-center"},"Tỷ lệ"),t("th",{scope:"col",class:"text-center"},"Số lượng"),t("th",{scope:"col",class:"text-center"},"Hoàn thành"),t("th",{scope:"col",class:"text-center"},"Tỷ lệ")])],-1)),t("tbody",null,[(u(!0),s(p,null,T(v.value,(a,_)=>(u(),s("tr",{key:w(a,_),onDblclick:l=>P(a)},[t("td",null,e(_+1),1),t("td",null,e(a.ma_tinh),1),t("td",null,e(a.ma_huyen),1),t("td",null,e(a.ma_xa||""),1),t("td",null,e(a.ten),1),t("td",W,e(a.dn_htx_so_luong),1),t("td",Y,e(a.dn_htx_hoan_thanh),1),t("td",Z,e(a.dn_htx_ty_le)+"%",1),t("td",nn,e(a.ho_so_luong),1),t("td",tn,e(a.ho_hoan_thanh),1),t("td",_n,e(a.ho_ty_le)+"%",1)],40,R))),128)),v.value.length===0?(u(),s("tr",an,n[17]||(n[17]=[t("td",{colspan:"11",class:"text-center"},"Không tìm thấy dữ liệu nào.",-1)]))):N("",!0)])])])])])]))}},ln=$(on,[["__scopeId","data-v-83bcf3a8"]]);export{ln as default};
